# AI Trading Model – Random Forest Trend Predictor

## Machine-Learning model that forecasts next-day price direction and simulates a trading strategy

This project builds a complete, end-to-end AI trading system using Yahoo Finance market data, technical indicators, a Random Forest classifier, and a simple rule-based strategy. It downloads OHLCV data automatically, engineers predictive features, trains a model to forecast next-day direction, and evaluates a long-only strategy against the market. The project is fully reproducible, self-contained, and ready for portfolios or GitHub.

---

## Data Flow Diagram & System Architecture


![DFD](https://github.com/Torajabu/AI-Trading-Model/blob/main/architecture.svg)

---

## Data Preprocessing

### Data Cleansing Steps

* Loads raw OHLCV data directly from Yahoo Finance using `yfinance`.
* Validates that downloaded data is non-empty.
* Sorts data by date and ensures proper index alignment.
* Removes rows containing missing values generated by rolling calculations.

### Feature Engineering

* Daily **Returns**
* Next-day **Direction label** (Up/Down)
* Technical indicators:

  * **SMA10** (short-term trend)
  * **SMA50** (medium-term trend)
  * **EMA20** (exponential average)
  * **RSI14** (Wilder’s Relative Strength Index with correct formula)
* All features combined into a supervised ML dataset
* No future leakage: direction is shifted by one day

---

## Results

![Result GIF](path/to/strategy_results.png)

The output visualization compares market returns vs the model-driven strategy. When the strategy curve rises above the market curve, model predictions outperform simple buy-and-hold.

---

## Requirements

* Python 3.8 or higher
* yfinance
* pandas
* numpy
* matplotlib
* scikit-learn

*(Create a requirements.txt if desired.)*

---

## Installation

```bash
git clone https://github.com/Torajabu/AI-Trading-Model.git
cd AI-Trading-Model

python -m venv venv
source venv/bin/activate      # or venv\Scripts\activate on Windows
pip install -r requirements.txt
```

---

## Quick Start

1. Clone this repository.
2. Ensure dependencies are installed.
3. Run the main script:

```bash
python trading_model.py
```

### Configuration Example

```python
symbol = "AAPL"
period = "2y"
```

The script automatically downloads data, prepares features, trains the model, backtests the strategy, and plots results.

---

## Output

The program generates:

* **Predicted next-day trend** for each date
* **Position values** (1 = long, 0 = flat)
* **Daily strategy returns**
* **Cumulative returns for both market and strategy**
* **Matplotlib performance plot**
* **Printed evaluation metrics** (accuracy, classification report)

Example exported fields:

* Close
* Return
* Pred_Dir
* Position
* Market_Cum
* Strategy_Cum

---

## How It Works

1. **Download OHLCV data** using Yahoo Finance.
2. **Engineer features** including returns, SMAs, EMA, and RSI.
3. **Create next-day direction label** for supervised classification.
4. **Split data** into train and test sets (time-series style, no shuffling).
5. **Train RandomForestClassifier** to map features → next-day direction.
6. **Predict directions** across the entire dataset.
7. **Simulate trading logic**:

   * If previous prediction = Up → take long position
   * If previous prediction = Down → stay in cash
8. **Compute daily and cumulative returns** for both the market and strategy.
9. **Visualize performance** via equity curves.

---

## Theory Behind the Implementation

The Random Forest model attempts to identify directional bias in short-term price movements using:

* Price-based indicators
* Momentum indicators
* Trend measures

**Direction label definition**:

Direction_t = 1  if Close(t+1) > Close(t)
Direction_t = 0  otherwise

**RSI formula (Wilder’s method):**

RSI = 100 - (100 / (1 + AverageGain / AverageLoss))

**Trading logic**:

Position[t]       = PredictedDirection[t-1]
StrategyReturn[t] = Position[t] * Return[t]

---

## Performance Metrics

*(Values depend on ticker and period.)*

* **Accuracy**: Printed after training
* **Precision / Recall / F1-score**: Included in classification report
* **Strategy cumulative return**: Displayed visually
* **Market cumulative return**: Displayed visually
* **Execution time**: Typically <2 seconds for 2 years of data

---

## Usage Tips

* Increase period size for more reliable model training.
* Add more technical indicators to improve signal quality.
* Test multiple tickers; different stocks behave differently.
* Tune hyperparameters of Random Forest (`max_depth`, `n_estimators`).
* Do not shuffle the data; this breaks time dependence.

### Troubleshooting

* **Data download empty**

  * Check ticker symbol or internet connection
* **Plot not showing**

  * Ensure `matplotlib` backend is correct
* **Low accuracy**

  * Extend the dataset
  * Add new indicators
  * Adjust model hyperparameters

---

## File Structure

```
AI-Trading-Model/
├── trading_model.py            # Main project script
├── dataset_info.md             # Information about downloaded features
├── strategy_results.png        # Market vs strategy visualization
└── README.md                   # Project documentation
```

---

## Educational Value

This project demonstrates:

* Full ML pipeline for financial forecasting
* Time-series-appropriate feature engineering
* Model evaluation using classification metrics
* A real backtesting workflow
* Comparing market vs model-driven strategies

---

## Applications

* Beginner-friendly quantitative finance project
* Resume / portfolio showcase
* Starting point for more complex ML trading systems
* Teaching tool for supervised learning on time-series
* Prototype for automated strategy testing

---

## Post Mortem Notes

### What Worked Well

* Clean end-to-end pipeline
* Proper RSI implementation
* Time-series appropriate model training
* Clear visual evaluation

### Challenges Encountered

* Model simplicity limits long-term profitability
* Sensitive to indicator quality
* Strategy assumes no transaction costs

### Lessons Learned

* More features often improve accuracy
* Proper labeling prevents data leakage
* Visualization is essential for strategy validation

### Future Improvements

* Add MACD, Bollinger Bands, ATR
* Hyperparameter optimization
* More advanced ML models (XGBoost, SVM)
* Deep learning (LSTM, GRU)
* Full backtest engine with risk metrics

### Performance Insights

* Short-term predictions are noisy
* Returns improve with regime-specific indicators
* Forest models benefit from larger feature sets

### Technical Debt

* No caching system for downloaded data
* No config file or CLI interface
* Single-file structure; could be modularized

---

## Important Notes

* This is an educational model; it is **not** financial advice.
* Past performance does not guarantee future results.
* Strategy does not include slippage, fees, or liquidity constraints.
* Signals may degrade significantly during volatile markets.

---

## References

* scikit-learn Documentation
* Yahoo Finance Data API
* Technical Analysis literature

---
